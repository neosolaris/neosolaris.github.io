---
title: Small and Simple Nextvi
date: 2024-04-18T07:19:18+09:00
tags: ["Editor","vi","nextvi"]
categories: ["Editor"]
---

last updated: {{ "1713578403" | date: "%Y-%m-%d %H:%M" }}

```
vi는 배우는 것이 아니라 몸으로 익히는 것이다.
vi는 단순하고 일관성이 있다.
```

## Intro

* 장점
	- vi의 기본 명령을 제공한다.
	- 단순하고 용량이 작아 임베디드 환경 및 원격지에서 사용하기에 좋다.
	- [neatvi](neatvi)로 부터 여러 기능이 추가되었다.
	- vim, nvim과는 다르게 간단한 설정과 빠른 동작이 장점이다.
	- 오픈소스 nvi 등과는 다르게 utf-8을 지원한다. 한글도 지원.
	- 터미널을 ex-mode(명령라인)에서 불러올 수 있다.
	- 각종 플러그인이 없는 대신 ex-mode에서 터미널 툴을 사용할 수 있다.  
	
	
* nextvi가 좋은 이유

개인적으로 vim보다는 nvim을 더 선호한다. lua와 결합된 플러그인과의 연결이 정말 좋기 
때문이다. 하지만 단점도 많다. lua를 공부해야하고 또 설정에 적응하려면 많은 시간과 노력이 
필요하다. 더군다나 수많은 플러그인을 장착하게 되면 느려지고 무거워진다. 설정이 잘 못 
되면 바로 잡느라 삽질을 해야한다. 물론 자신만의 설정을 잘 만들어서 백업해 두었다가 
재사용하면 좋다. 하지만 nvim 자체의 패키지 사이즈와 수 많은 플러그인의 사이즈를 생각하면 
작고 가볍게라는 말이 무색해진다.

데비안을 쓰는 경우에는 더욱 문제가 많아진다. 버전이 낮아 플러그인 적용이 어려운 경우가 
빈번히 발생한다. 최신 소스를 받아 컴파일하면 되지만 이것도 쉽지 않다. 컴파일 환경을 
만들고 필요한 라이브러리를 준비하고 에러가 나면 이를 상황에 맞게 조정해 주어야 한다. 
더군다나 라즈베리파이 같은 환경에서는 더더욱 어렵다. 

이러 저러한 문제로 상황에 맞게 작고 가볍고 빠른 vi 에디터를 찾아보기 시작했다. vi의 
수많은 변종과 후손들 중에 `nvi`를 찾았다. 소스를 가져다 컴파일해서 쓰기에도 문제가 
없다. 하지만 한글이 지원되지 않는다. 즉 utf8을 지원하지 않는다는 것이다. 이를 패치한 
것이 있는 지 알아보았지만 찾을 수 없었다.

다음은 [vis](vis) 라는 것을 찾았다. nvim과 같이 lua를 지원하고 더욱 놀라운 것은 여러 
줄을 동시에 편집할 수 있는 기능이 있다. 용량도 nvim에 비해 작고 빠르다. 한글도 지원이 
된다. 한 동안 공부하면서 사용하다가 조금씩 껄끄러운 면이 드러났다. lua 버전이 최신 
버전에 가깝기 때문에 luajit 기반으로 사용하는 입장에서 혼란을 준다. 더군다나 lua 플러그인도 
nvim에 비해서 많이 부족하다. 필요한 것이 대부분 없다고 봐도 무방하다. 이것을 사용하는 
유일한 장점은 다중 라인 편집이라고 생각한다. 전문 코딩을 하는 것이 아니기 때문에 개인적으로 
그렇게 와닿지 않았다.

그 다음으로 찾은 것이 `neatvi`이다. 말 그대로 neat한 vi인 것이다. 정말 작고 간단하지만 
상태 표시와 코드 문법의 컬러 표시가 지원된다.  165kb 정도의 사이즈이다. 편집에 필요한 기본적인 
vi 명령은 모두 지원한다.  ex 명령줄에 터미널 명령과 상호 작용도 가능하다. 이것은 정말 
놀라운 것이다. 보통 `nvim` 의 기능과 플러그인에서 제공하는 것을 모두 터미널 명령과의 상호작용으로 
해결할 수 있기 때문이다. 더욱 놀라운 것은 터미널의 출력결과가 vim, nvim 등과는 다르게 
투명하게 아무 문제 없이 표시된다는 것이다. 즉 컬러와 한글, nerd font 등이 터미널 화면에 출력되는 
그대로 `neatvi`에서 출력된다는 것이다. `ls`,`find`,`grep`,`awk`,`sed` 등 수많은 쉘 
명령을 ex 모드에서 조합해 쓸 수 있다. 자주 빈번하게 사용된다면 스크립트나 프로그램을 
만들어서 플러그인 역할을 하게 만들면 그만이다. 

`neatvi`가 왜 훌륭한가. 여러 가지가 있지만 위에서 언급한 것 이외에 기본 c 라이브러리만을 
의존하고 그 어떤 의존성도 없다는 것이고, 더욱이 utf8을 지원하여 다국어 표시와 입력이 
가능하다는 점, 그럼에도 불구하고 작고 빠르다는 점이다. `작은 것이 아름답다`라는 유닉스 
철학과도 부합한다. 필요한 툴은 터미널 명령어와 상호작용하면 되는 것이다. 에디터는 파일 
편집에만 집중하면 그만이다. 드디어 에디터 찾아 삼만리는 이제 끝을 향하고 있었다.

작고 가볍고 임베디드 환경 및 여타 조건에서 사용할 수 있는 `neatvi` 를 매우 만족하면서 
쓰다가 조금 불편하다는 생각이 들었다. 고성능, 다기능의 nvim을 쓰다가 거의 아무 기능도 
없는 것을 쓰게 된 후유증 같은 것이다. 예를 들어 줄 번호를 표시할 수 없다거나 워드랩, 
현재 디렉토리 내의 파일검색 및 불러오기, auto indent, 문서 내의 단어 완성 지원 등이 그것이다. 
그래서 neatvi의 faq나 다른 사람의 요구사항 등을 살펴보다가 분기된 `nextvi`를 알게 되었다. 
`neatvi`로 부터 분기되어 여러 아쉬운 기능을 추가한 버전이다.

이러한 이유로 `nextvi` 를 최종적으로 선택하여 사용하게 되었다. 물론 `nvim`등에 비할 
바는 아니겠지만, 최소한의 기능과 성능으로 소스를 편집하거나 문서를 작성하는 데 있어 
매우 만족스럽다. 이에 더하여 소스 코딩 시에 `conf.c`라는 파일에 자신이 선호하는 언어의 
컬러를 설정해주고 컴파일해 사용한다면 더욱 쾌적한 환경이 된다. 물론 `vi.c` 파일을 편집하여 
자신만의 키매핑도 추가할 수 있다. 물론 복잡하다면 이러한 설정 변경 없이 써도 무방하다.

자 그럼 설치부터 기본 사용법, 그리고 응용까지 정리해볼까 한다.


## 설치

* 설치전에 gcc, clang, tinycc 등의 컴파일러가 있어야한다.
* 컴파일 후 `vi`를 적절한 위치로 옮기고 `PATH`에 추가한다.

```console
$ git clone https://github.com/kyx0r/nextvi
$ cd nextvi
$ ./build.sh
$ ./vi
```

## 기본 사용법

vi의 기본 명령과 모두 호환된다.

* 파일 열기

```console
$ vi  # 파일이름 없이 열기 (:wq <filename> 으로 저장하고 종료)
$ vi file_name.c  # 파일이름 열기 (:wq 로 저장하고 종료)
```

* 파일 저장 및 종료 (ex-mode)

```vi
:w              (저장)
:q              (나가기: 편집하지 않고)
:q!             (강제로 나가기: 문서 변경 무시)
:wq <filename>  (filename으로 저장하고 종료)
:wq             (저장하고 종료)
:wq!            (강제로 저장하고 종료)
```

* 이동
	- `h` - 커서 앞으로 한 칸 이동
	- `l` - 커서 뒤로 한 칸 이동
	- `k` - 커서 위로 한 칸 이동
	- `j` - 커서 밑으로 한 칸 이동
	- `^` - 행의 첫 글자로 이동
	- `$` - 행의 마지막 글자로 이동
	- `+` - 다음 행의 첫 글자로 이동
	- `-` - 이전 행의 첫 글자로 이동
	- `{` - 이전 문단 이동
	- `}` - 다음 문단 이동
	- `gg` - 문서의 처음으로 이동 (`1G`)
	- `G` - 문서의 마지막으로 이동
	- `H` - 화면의 맨 처음으로 이동
	- `M` - 화면의 중간으로 이동
	- `L` - 화면의 하단으로 이동
	- `w` - 다음 단어 이동
	- `b` - 이전 단어 이동
	- `:번호` - n 번째 행으로 이동
 
* 입력
	- `i` - 커서 바로 앞에서 입력하기
	- `I` - 커서 줄 맨 앞에서 입력하기
	- `a` - 커서 바로 뒤에서 입력하기
	- `A` - 커서 줄 맨  뒤에서 입력하기
	- `esc` - 입력을 종료하고 명령모드로 나가기
 
* 삭제
	- `dd`, `d1d` - 커서 행을 지우기
	- `3dd` - 커서 행 포함 아래로 3 줄 지우기
	- `d0` - 커서 위치에서 행의 처음까지 삭제
	- `D`, `d$` - 커서 위치에서 행의 끝까지 삭제
 
* 복사/ 붙이기
	- `3yw` - 커서 위치에서 3 단어 복사
	- `3yy` - 커서 위치에서 3 줄 복사
	- `p`,`1p` - 복사 또는 지운 것을 커서 기준 1번 붙이기
	
## 응용


## Links

* Next Vi Home
	- <https://github.com/kyx0r/nextvi>
* Neat Vi Home
	- <https://github.com/aligrudi/neatvi>

